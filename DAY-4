# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1zY9s1wyZssxtQwIC_oMhrE3_wkXVR7Wi
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sb
from sklearn.cluster import KMeans
from sklearn.metrics import pairwise_distances_argmin_min
from mpl_toolkits.mplot3d import Axes3D
plt.rcParams['figure.figsize'] = (16, 9)
plt.style.use('ggplot')

dataset = pd.read_csv("http://iali.in/datasets/IEEEAPSIT/unsupervised-ml/Wholesale%20customers%20data.csv")
dataset.head()

dataset.describe()

print(dataset.groupby('Region').size())

dataset1=dataset.drop(['Channel'],1)
dataset1.drop(['Region'],1).hist()
plt.show()

sb.pairplot(dataset1.dropna(), hue='Region',size=4,vars=["Fresh","Grocery","Delicassen"],kind='scatter')

X = np.array(dataset1[["Fresh","Grocery","Delicassen"]])
y = np.array(dataset1['Region'])
X.shape

fig = plt.figure()
ax = Axes3D(fig)
colores=['blue','red','green','blue','cyan','yellow','orange','black','pink','brown','purple']
asignar=[]
for row in y:
    asignar.append(colores[row])
ax.scatter(X[:, 0], X[:, 1], X[:, 2], c=asignar,s=60)

Nc = range(1, 20)
kmeans = [KMeans(n_clusters=i) for i in Nc]
kmeans
score = [kmeans[i].fit(X).score(X) for i in range(len(kmeans))]
score
plt.plot(Nc,score)
plt.xlabel('Number of Clusters')
plt.ylabel('Score')
plt.title('Elbow Curve')
plt.show()



"""K-MEANS, K=8"""

kmeans = KMeans(n_clusters=8).fit(X)
centroids = kmeans.cluster_centers_
print(centroids)

